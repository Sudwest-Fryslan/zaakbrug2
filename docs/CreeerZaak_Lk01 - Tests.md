# Integration Tests
## ZaaktypeNotPresentForZaakcodeShouldThrowConversionError
Zaaktype is based on zaakcode when converted from ZDS. A zaaktype with the given zaakcode is needed.

`Assert on HTTP GET returning no result for GetZaaktypeByZaakcode.`

## IdentificatieAndBronorganisatieNotUniqueShouldThrowConversionError
In ZDS identificatie is optional, so it will pass input validation. Identificatie and bronorganisatie form a unique key for a zaak in ZGW. If no indentificatie is given in the input, it should be generated by the ZGW API.

`Assert on HTTP GET GetZgwZaakByIdentificatieAndBronorganisatie returning a zaak.`

## EndStatusWhenNoResultaatAndNoInjectionConfigShouldThrowConversionError
In ZDS its not necessary to have a resultaat present when closing a zaak. In ZGW a resultaat needs to be present before closing a zaak. Effort should be made to inject a resultaat before closing a zaak with an injection config. If the config is not present, the conversion can't be done.

`Assert on HTTP GET GetZgwResultaat returning nothing && CONFIG GET GetEndDateAndResultLastStatus returning nothing`

## EinddatumSetWithoutEndStatusPresentAndNoInjectionConfigShouldThrowConversionError
If the ZDS einddatum is set, it means the zaak is closed. In ZGW a zaak is closed when the EndStatus is set. If the ZDS einddatum is set, but the endStatus is missing, effort should be made to inject the endstatus and close the zaak according to ZGW. If no config is present for the zaaktype to inject the endstatus and potential resultaat, it cant convert.

`Assert on einddatum being set && CONFIG GET GetEndCaseEndDate returning nothing`

## IndicatieGebruiksrechtNotSetOnAllInformatieObjectWhenEndStatusShouldThrowConversionError
All IndicatieGebruiksrecht on Informatieobject resources on a zaak, should be set to a valid value before a zaak is being closed

`Assert when EindStatus is present && any IndicatieGebruiksrecht on Informatieobject(en) is empty or null`

## NoVertrouwelijkheidaanduidingWhenEndstatusShouldThrowConversionError

`Assert when Eindstatus is present && vertrouwelijkheidaanduiding is not set`

## NewEndstatusWhenEndstatusAlreadyPresentShouldIgnoreNewEndstatus

`Assert when Eindstatus is present in both input and ZGW API && ZGW API Eindstatus datumgezet matches input Eindstatus datumgezet` TODO: Should it be ignored or should the newest always replace the older one? OZB ignores.

## NewResultaatShouldReplaceExistingResultaat

`Assert on existing resultaat not being present anymore after new resultaat insertion`

## LaatsteBetaaldatumNotNullWhenBetalingsindicatieSetNvtShouldThrowConversionError

`Assert on laatsteBetaaldatum being not null && Betalingsindicatie set to nvt`

## ProductenOfDienstenTypeNotPresentInZaakTypeShouldThrowConversionError

`Assert on productenOfDiensten url reference not being present as type under the given zaaktype.`

## StatusOfStatusTypeNotPresentInZaaktypeShouldThrowConversionError

`Assert on statustype url reference not being present as type under the given zaaktype.`

## InformatieobjectOfInformatieobjectTypeNotPresentInZaaktypeShouldThrowConversionError

`Assert on informatieobjectType url reference not being present as type under the given zaaktype.`

## EigenschapOfEigenschapTypeNotPresentInZaaktypeShouldThrowConversionError

`Assert on eigenschapType url reference not being present as type under the given zaaktype.`

## RolOfRolTypeNotPresentInZaaktypeShouldThrowConversionError

`Assert on rolType url reference not being present as type under the given zaaktype.`

## ResultaatOfResultaatTypeNotPresentInZaaktypeShouldThrowConversionError

`Assert on resultaatType url reference not being present as type under the given zaaktype.`

## HeeftBetrekkingOpAndereZaakOtherZaakNotPresentShouldThrowConversionError

`Assert on HeeftBetrekkingOpAndere HTTP GET zaak url not returning a zaak.`

## EindstatusNotUsingZaakEinddatumAsDatumGezetShouldThrowConversionError

`Assert on eindstatus datum gezet not being equal to zaak einddatum.`

## NewStatusWithSameDatumGezetAsAnyExistingStatusShouldBeIgnored

`Assert on datum gezet of new status being equal to datum gezet of any existing status.`

## NewStatusWithSameDatumGezetAsAnyExistingStatusAndNotBeingOfTheSameStatusTypeShouldThrowConversionError

`Assert on datum gezet of new status being equal to datum gezet of any existing status && statustype url not being the same.`

## ResultaatTypeArchiefnominatieShouldBeUsedWhenArchiefnominatieNotPresentOnZaakWhenEndStatus
When input contains Eindstatus and zaak archiefnominatie not set, it should copy over the archiefnominatie from the resultaatType.

https://vng-realisatie.github.io/gemma-zaken/standaard/zaken/index#zrc-021

`Assert on zaak archiefnominatie not equal to resultaatType archiefnominatie`

## BrondatumShouldEqualZaakEinddatumWhenBrondatumArchiefprocedureIsAfgehandeld
> Zaak archiefactiedatum is a result of **brondatum** + resultaatType archieftermijn. The function to determine the **brondatum** part is based on the resultaattype brondatumArchiefprodure.

https://vng-realisatie.github.io/gemma-zaken/standaard/zaken/index#zrc-021

`Assert on brondatum not being equal to zaak einddatum.`

## BrondatumShouldEqualHoofdzaakEinddatumWhenBrondatumArchiefprocedureIsHoofdzaak
> Zaak archiefactiedatum is a result of **brondatum** + resultaatType archieftermijn. The function to determine the **brondatum** part is based on the resultaattype brondatumArchiefprodure.

https://vng-realisatie.github.io/gemma-zaken/standaard/zaken/index#zrc-021

`Assert on brondatum not being equal to hoofdzaak einddatum && BrondatumArchiefprocedure being equal to afgehandeld.`

## BrondatumShouldEqualValueOfEigenschapWithNameFromDatumkenmerkWhenBrondatumArchiefprocedureIsHoofdzaak
ResultaatType brondatumArchiefProcedure contains the field datumkenmerk that represents the name of the eigenschap that has the brondatum as value.

> Zaak archiefactiedatum is a result of **brondatum** + resultaatType archieftermijn. The function to determine the **brondatum** part is based on the resultaattype brondatumArchiefprodure.

https://vng-realisatie.github.io/gemma-zaken/standaard/zaken/index#zrc-021

`Assert on brondatum not being equal to value of eigenschap with the name from resultaatType brondatumArchiefProcedure datumkenmerk && BrondatumArchiefprocedure being equal to hoofdzaak`

## BrondatumShouldEqualZaakArchiefactiedatumWhenBrondatumArchiefprocedureIsAnderDatumKenmerk
> Zaak archiefactiedatum is a result of **brondatum** + resultaatType archieftermijn. The function to determine the **brondatum** part is based on the resultaattype brondatumArchiefprodure.

https://vng-realisatie.github.io/gemma-zaken/standaard/zaken/index#zrc-021

`Assert on brondatum not being equal to the value of zaak archiefactiedatum && BrondatumArchiefprocedure being equal to ander_datumkenmerk`

## ZaakArchiefactiedatumShouldBeSetWhenBrondatumArchiefprocedureIsAnderDatumKenmerk
In this scenario the zaak archiefactiedatum is supposed to manually set. When this procedure is being used, we should check if the archiefactiedatum is actually set.

> Zaak archiefactiedatum is a result of **brondatum** + resultaatType archieftermijn. The function to determine the **brondatum** part is based on the resultaattype brondatumArchiefprodure.

https://vng-realisatie.github.io/gemma-zaken/standaard/zaken/index#zrc-021

`Assert on zaak archiefactiedatum not being set && BrondatumArchiefprocedure equals ander_datumkenmerk.`

## BrondatumShouldEqualToValueOfAttributeDeductedFromObjecttypeWhenBrondatumArchiefprocedureIsZaakobject
In this scenario we iterate through all objects related to the zaak of the objecttype of BrondatumArchiefProcedure objecttype. Then we use the BrondatumArchiefprocedure datumkenmerk field as name of the attribute we should use on the related objects. We then compare each attribute for all related objects and pick the value with the latest date as brondatum.

> Zaak archiefactiedatum is a result of **brondatum** + resultaatType archieftermijn. The function to determine the **brondatum** part is based on the resultaattype brondatumArchiefprodure.

https://vng-realisatie.github.io/gemma-zaken/standaard/zaken/index#zrc-021

`Assert on magic.`

## BrondatumShouldEqualZaakEinddatumPlusProcestermijnWhenBrondatumArchiefprocedureIsTermijn
The brondatum is based on the zaak einddatum + brondatumArchiefprocedure procestermijn. This validation needs to happen before the zaak is actually closed, but the zaak einddatum would not be set yet. The zaak einddatum is deducted from datumGezet of the eindstatus that is about to be applied. Therefor we need to check

> Zaak archiefactiedatum is a result of **brondatum** + resultaatType archieftermijn. The function to determine the **brondatum** part is based on the resultaattype brondatumArchiefprodure.

https://vng-realisatie.github.io/gemma-zaken/standaard/zaken/index#zrc-021

`Assert on brondatum not being equal to the sum of the pending eindstatus datumgezet + brondatumArchiefprocedure procestermijn && BrondatumArchiefprocedure being equal to termijn` 

TODO: Need to check if eindstatus can actually be used here.

## BrondatumShouldEqualZaakEinddatumFromGerelateerdeZakenWhenBrondatumArchiefprocedureIsGerelateerdeZaak
We iterate through all gerelateerde zaken and take the einddatum on the zaak that is the latest date.

> Zaak archiefactiedatum is a result of **brondatum** + resultaatType archieftermijn. The function to determine the **brondatum** part is based on the resultaattype brondatumArchiefprodure.

https://vng-realisatie.github.io/gemma-zaken/standaard/zaken/index#zrc-021

`Assert on brondatum not being equal to the zaak einddatum of the zaak with the latest date einddatum && BrondatumArchiefprocedure being equal to gerelateerde_zaak.` 

## BrondatumShouldEqualIngangsdatumBesluitWhenBrondatumArchiefprocedureIsIngangsdatumBesluit
We iterate through all gerelateerde besluiten and take the ingangsdatum on the besluit that is the latest date.

> Zaak archiefactiedatum is a result of **brondatum** + resultaatType archieftermijn. The function to determine the **brondatum** part is based on the resultaattype brondatumArchiefprodure.

https://vng-realisatie.github.io/gemma-zaken/standaard/zaken/index#zrc-021

`Assert on brondatum not being equal to the ingangsdatum of the besluit with the latest date ingangsdatum && BrondatumArchiefprocedure being equal to ingangsdatum_besluit.` 

## BrondatumShouldEqualVervaldatumBesluitWhenBrondatumArchiefprocedureIsVervaldatumBesluit
We iterate through all gerelateerde besluiten and take the vervaldatum on the besluit that is the latest date.

> Zaak archiefactiedatum is a result of **brondatum** + resultaatType archieftermijn. The function to determine the **brondatum** part is based on the resultaattype brondatumArchiefprodure.

https://vng-realisatie.github.io/gemma-zaken/standaard/zaken/index#zrc-021

`Assert on brondatum not being equal to the vervaldatum of the besluit with the latest date vervaldatum && BrondatumArchiefprocedure being equal to vervaldatum_besluit.` 